(this["webpackJsonpbackboard-app"]=this["webpackJsonpbackboard-app"]||[]).push([[0],{37:function(e,t,n){},59:function(e,t,n){},65:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(15),o=n.n(a),s=(n(37),"auth_token");function i(){console.log("usetoken called");var e=localStorage.getItem(s);if(e)return e;var t=new URLSearchParams(window.location.search).get("token");return null!==t&&(localStorage.setItem(s,t),window.history.pushState({},document.title,window.location.pathname)),t}var u=n(8),l=n(11),d=n(3),h=n.n(d),j=n(29),p=n.n(j);var b=n(1),f={authApi:"https://whoamong.us",authPath:"/.netlify/functions/auth",origin:window.location.href},x=function(){return Object(b.jsx)("a",{href:"".concat(f.authApi).concat(f.authPath,"?origin=").concat(f.origin),style:{textDecoration:"none",color:"var(--text-color)"},children:"Login"})};function v(e){var t=e.children,n=e.gap;return Object(b.jsx)("div",{style:{display:"flex",flexDirection:"column",rowGap:"".concat(n,"px")},children:t})}function O(e){var t=e.height;return Object(b.jsx)("div",{style:{height:"".concat(t,"px")}})}function g(e){var t=e.children;return Object(b.jsx)("span",{style:{color:"var(--text-color)"},children:t})}function m(e){var t=e.children,n=e.htmlFor;return Object(b.jsx)("label",{htmlFor:n,children:Object(b.jsx)(g,{children:t})})}function y(e){var t=e.value,n=e.name,r=e.onChange,c=e.disabled;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(m,{htmlFor:n,children:n}),Object(b.jsx)("input",{type:"text",name:n,value:t,style:{border:"var(--border)"},onChange:function(e){var t=e.target.value;return r(t)},disabled:c})]})}function k(e){var t=e.value,n=e.name,r=e.onChange,c=e.disabled;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(m,{htmlFor:n,children:n}),Object(b.jsx)("textarea",{name:n,value:t,style:{border:"var(--border)"},onChange:function(e){var t=e.target.value;return r(t)},disabled:c})]})}function w(e){e.label;var t=e.onClick,n=e.state;return Object(b.jsx)("input",{type:"submit",disabled:"attempt"===n,onClick:function(e){e.preventDefault(),t()},value:S(n),style:{appearance:"none",border:"var(--border)",color:"var(--text-color)",backgroundColor:"var(--white)"}})}function S(e){switch(e){case"initial":return"Submit";case"attempt":return"Shoots!";case"success":return"Score!";case"fail":return"Air ball"}}var C="head.json";function I(e){var t=e.loggedIn,n=Object(r.useState)(""),c=Object(l.a)(n,2),a=c[0],o=c[1],s=Object(r.useState)("initial"),d=Object(l.a)(s,2),j=d[0],f=d[1],g=Object(r.useState)(""),m=Object(l.a)(g,2),S=m[0],I=m[1],F=function(){var e=i();return p.a.create({baseURL:"https://api.github.com/repos/iryan2/backboard-page/contents/links/",headers:{Authorization:"Bearer ".concat(e)}})}();function L(){return(L=Object(u.a)(h.a.mark((function e(){var t,n,r,c,s,i,u,l,d,j,p,b,x,v,O;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.get(C);case 2:return t=e.sent,f("attempt"),n=t.data,r=n.sha,c=n.content,s={sha:r,id:JSON.parse(atob(c)).head},console.log("head before writing new link",s),i={id:crypto.randomUUID(),title:a,href:S,time:(new Date).toISOString(),next:null,prev:s.id},console.log("newLink",i),e.next=11,F.put("".concat(i.id,".json"),{message:"Create new link: ".concat(i.title,"\n\n").concat(i.href),content:btoa(JSON.stringify(i))});case 11:return u=e.sent,console.log("response",u),e.next=15,F.get("".concat(s.id,".json"));case 15:return l=e.sent,d=l.data,console.log("prevResponse",d),j={id:d.id,content:JSON.parse(atob(d.content)),sha:d.sha},console.log("prev",j),j.content.next=i.id,e.next=23,F.put("".concat(s.id,".json"),{message:"Update prev for link: ".concat(i.title,"\n\n").concat(i.href),content:btoa(JSON.stringify(j.content)),sha:j.sha});case 23:return p=e.sent,console.log("updatedPrevResponse",p),e.next=27,F.get("head.json");case 27:return b=e.sent,x=b.data,(v={content:JSON.parse(atob(x.content)),sha:x.sha}).content.head=i.id,console.log("head content",v.content),e.prev=32,e.next=35,F.put("head.json",{message:"Update head for link: ".concat(i.title,"\n\n").concat(i.href),content:btoa(JSON.stringify(v.content)),sha:v.sha});case 35:O=e.sent,console.log("updatedHeadResponse",O),f("success"),o(""),I(""),setTimeout((function(){return f("initial")})),e.next=46;break;case 43:e.prev=43,e.t0=e.catch(32),f("fail");case 46:case"end":return e.stop()}}),e,null,[[32,43]])})))).apply(this,arguments)}return Object(b.jsx)("div",{style:{padding:"16px 0"},children:t?Object(b.jsx)("form",{children:Object(b.jsxs)(v,{gap:4,children:[Object(b.jsx)(y,{name:"title",value:a,onChange:function(e){return o(e)},disabled:"attempt"===j}),Object(b.jsx)(O,{height:4}),Object(b.jsx)(k,{name:"content",value:S,onChange:function(e){return I(e)},disabled:"attempt"===j}),Object(b.jsx)(O,{height:8}),Object(b.jsx)(w,{state:j,onClick:function(){return L.apply(this,arguments)}})]})}):Object(b.jsx)(x,{})})}n(59);var F=n(10),L=n(31),J=n(14),N=n(12),D=function(e){return e.links.head},P=function(e){return e.links.links},R="".concat("https://iryan2.backboard.page","/links"),U=Object(N.b)({name:"links",initialState:{head:"",links:[]},reducers:{headLoaded:function(e,t){return Object(J.a)(Object(J.a)({},e),{},{head:t.payload})},linkLoaded:function(e,t){return Object(J.a)(Object(J.a)({},e),{},{links:[].concat(Object(L.a)(e.links),[t.payload])})}}}),A=U;function T(){return B.apply(this,arguments)}function B(){return(B=Object(u.a)(h.a.mark((function e(){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(R,"/head.json"));case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e){return H.apply(this,arguments)}function H(){return(H=Object(u.a)(h.a.mark((function e(t){var n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(R,"/").concat(t,".json"));case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var W=function e(t){return function(){var n=Object(u.a)(h.a.mark((function n(r){var c;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,E(t);case 3:c=n.sent,r(U.actions.linkLoaded(c)),c.prev&&r(e(c.prev)),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),console.error(n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e){return n.apply(this,arguments)}}()};function q(e){var t=e.children;return Object(b.jsx)("div",{style:{borderRadius:"4px",border:"1px solid var(--light-grey)",padding:"16px"},children:t})}function z(e){var t=e.children;return Object(b.jsx)("div",{style:{height:"400px",display:"flex",justifyContent:"center",alignItems:"center",background:"var(--black)"},children:t})}function G(e){var t,n=e.href,r=n.split("https://i.imgur.com/")[1];r||(r=n.split("https://imgur.com/")[1]);var c=r.split("."),a=Object(l.a)(c,2),o=a[0];return"gifv"===a[1]?Object(b.jsx)(z,{children:Object(b.jsxs)("video",{style:{height:"100%"},controls:!0,children:[Object(b.jsx)("source",{src:"https://i.imgur.com/".concat(o,".mp4"),type:"video/mp4"}),Object(b.jsx)("source",{src:"https://i.imgur.com/".concat(o,".webm"),type:"video/webm"})]})}):(setTimeout(null===(t=window.imgurEmbed)||void 0===t?void 0:t.createIframe(),1e3),Object(b.jsx)(z,{children:Object(b.jsx)("blockquote",{className:"imgur-embed-pub",lang:"en","data-id":o})}))}var M=n(19);function $(e){var t=e.href,n=t.lastIndexOf("/"),r=t.slice(n+1,t.length).split("?")[0].split("#")[0];return parseInt(r)?Object(b.jsx)(z,{children:Object(b.jsx)(M.b,{tweetId:r})}):Object(b.jsx)(z,{children:Object(b.jsx)(M.a,{sourceType:"url",url:t,options:{height:400},noHeader:!0,noFooter:!0})})}function _(e){var t=e.href;switch(function(e){var t=e.indexOf(".",e.lastIndexOf("/")+1);if(-1===t)return!1;var n=e.substr(t+1),r=n.search(/$|[?#]/);return n.substring(0,r)}(t)){case"jpg":case"jpeg":case"png":case"gif":return Object(b.jsx)(z,{children:Object(b.jsx)("a",{href:t,children:Object(b.jsx)("img",{src:t,alt:"interesting content",style:{maxHeight:"100%",maxWidth:"100%",objectFit:"contain"}})})})}return t.includes("twitter.com")?Object(b.jsx)($,{href:t}):t.includes("imgur.com")?Object(b.jsx)(G,{href:t}):null}function K(e){var t=e.children,n=e.href;return Object(b.jsx)("div",{style:{color:"var(--text-color)"},children:Object(b.jsxs)(q,{children:[t,Object(b.jsx)(_,{href:n})]})})}function Q(){var e=Object(F.b)(),t=Object(F.c)(D),n=Object(F.c)(P);return Object(r.useEffect)((function(){t||e(function(){var e=Object(u.a)(h.a.mark((function e(t,n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t(function(){var e=Object(u.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,T();case 3:n=e.sent,t(U.actions.headLoaded(n.head)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}());case 3:if(!(r=D(n()))){e.next=7;break}return e.next=7,t(W(r));case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n){return e.apply(this,arguments)}}())}),[e,t]),Object(b.jsx)("section",{style:{width:"100%",maxWidth:"450px"},children:Object(b.jsx)(v,{gap:8,children:n.map((function(e){return Object(b.jsxs)(K,{href:e.href,children:[Object(b.jsx)("a",{href:e.href,style:{textDecoration:"none",color:"var(--text-color)"},children:e.title}),Object(b.jsx)("br",{}),Object(b.jsx)("pre",{style:{overflow:"hidden",textOverflow:"ellipsis"},children:e.href})]},e.id)}))})})}var V=function(){var e="string"===typeof i();return Object(b.jsxs)("div",{className:"App",children:[Object(b.jsx)(I,{loggedIn:e}),Object(b.jsx)(Q,{})]})},X=n(7),Y=Object(X.b)({links:A.reducer}),Z=Object(N.a)({reducer:Y}),ee=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,67)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),r(e),c(e),a(e),o(e)}))};o.a.render(Object(b.jsxs)(c.a.StrictMode,{children:[Object(b.jsx)(F.a,{store:Z,children:Object(b.jsx)(V,{})}),","]}),document.getElementById("root")),ee()}},[[65,1,2]]]);
//# sourceMappingURL=main.1960a8fa.chunk.js.map